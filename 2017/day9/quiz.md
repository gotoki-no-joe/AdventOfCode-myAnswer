# 9日目：ストリーム処理 #

大きな流れがあなたの道を塞ぎます。
地元の人によると、**ごみ**でいっぱいなため
現時点で川を渡ることは安全ではない。
あなたは川を見下ろす。
あなたはそれが水の流れではなく**文字のストリーム**であることを発見します。

あなたはしばらく座ってストリームの一部（パズル入力）を記録します。
文字は**グループ**を表します。
このグループとは`{`で始まり`}`で終わる列です。
グループの中には、0個以上のカンマで区切られた他のものがあります。
それは別の**グループ**または**ごみ**です。
グループには他のグループを含めることができるので、
ひとつの`}`は
最後に開いた閉じられていないグループひとつだけを閉じます。
つまり、グループは入れ子が可能です。
あなたのパズル入力は単一の大きなグループを表します。
それは小さなものを多く含んでいます。

時には、グループの代わりに、あなたは**ごみ**を見つけるでしょう。
ごみは`<`で始まり`>`で終わります。
これらの三角括弧の間には、
`{`や`}`を含むほぼすべての文字が現れることができます。
ごみの**中**では`<`は特別な意味を持ちません。

ごみを片付けるという無駄な試みでは、
あるプログラムが`!`を用いてその中の文字の一部を**キャンセル**しました。
ごみの内側で`!`の次に来る**任意の**文字
（これには`<`, `>`, `!`も含まれる）は**無視**する必要がある。

これらの規則から逸脱した文字は現れません。(無視しろ、という意味かも。)
ごみの外には正しい形式のグループのみが現れ、
ごみは常に上記の規則に従って終了します。

自己完結したごみの例を示します。

- `<>` 空のごみ。
- `<random characters>` ランダムな文字を含むごみ。
- `<<<<>` 余分な`<`は無視されます。
- `<{!>}>` ひとつめの`>`はキャンセルされるためです。
- `<!!>` ふたつめの`!`がキャンセルされ、`>`がごみを終了させるためです。
- `<!!!>>` ふたつめの`!`とひとつめの`>`がキャンセルされるためです。
- `<{o"i!a,<{i<a>` これは最初の`>`で終了します。

ストリーム全体とそこに含まれるいくつかのグループの例を示します。

- `{}` 1グループ。
- `{{{}}}` 3グループ。
- `{{},{}}` これもまた3グループ。
- `{{{},{},{{}}}}` 6グループ。
- `{<{},{},{{}}>}` 1グループ（それはごみを含んでいます）。
- `{<a>,<a>,<a>,<a>}` 1グループ。
- `{{<a>},{<a>},{<a>},{<a>}}` 5グループ。
- `{{<!>},{<!>},{<!>},{<a>}}` 2グループ
（最後の`>`を除くすべてがキャンセルされるため。）

あなたの目標は、あなたの入力に含まれるすべてのグループの
合計スコアを見つけることです。
各グループには、
それを直接含むグループのスコアより1つ多い**スコア**が割り当てられます。
（一番外側のグループはスコア1です。）

- `{}` スコア1。
- `{{{}}}` スコア$1 + 2 + 3 = 6$。
- `{{},{}}` スコア$1 + 2 + 2 = 5$。
- `{{{},{},{{}}}}` スコア$1 + 2 + 3 + 3 + 3 + 4 = 16$。
- `{<a>,<a>,<a>,<a>}` スコア1。
- `{{<ab>},{<ab>},{<ab>},{<ab>}}` スコア$1 + 2 + 2 + 2 + 2 = 9$。
- `{{<!!>},{<!!>},{<!!>},{<!!>}}` スコア$1 + 2 + 2 + 2 + 2 = 9$。
- `{{<a!>},{<a!>},{<a!>},{<ab>}}` スコア$1 + 2 = 3$。

あなたの入力に含まれるすべてのグループの**合計スコア**はいくらですか？

# パート2 #

今、ごみを取り除く準備ができました。

あなたがごみを除去したことを証明するためには、
ごみの中のすべての文字を数える必要があります。
先頭と末尾の`<`と`>`はカウントせず、
またキャンセルされた文字やキャンセルをする`!`もカウントしません。

- `<>` 0文字。
- `<random characters>` 17文字。
- `<<<<>` 3文字。
- `<{!>}>` 2文字。
- `<!!>` 0文字。
- `<!!!>>` 0文字。
- `<{o"i!a,<{i<a>` 10文字。

あなたのパズル入力には、**キャンセルされていない文字はいくつありましたか？**
