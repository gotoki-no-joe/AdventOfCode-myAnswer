# 第16日: トナカイ迷路

[トナカイオリンピック](../../2015/day14/quiz.md)の季節がやってきました！
今年の大イベントは**トナカイ迷路**で、トナカイたちは**最小スコア**を競います。

あなたと歴史学者たちは、イベントが始まろうとしているちょうどその時に主任を探しに到着します。
少し見るのも悪くないですよね？

トナカイはスタートタイル（`S` と表示）から**東**を向いてスタートし、
エンドタイル（`E` と表示）に到達する必要があります。
彼らは1回に1タイル前進することができます（スコアを1ポイント増加させます）。
ただし、壁（`#`）には決して入ることができません。
また、彼らは時計回りまたは反時計回りに90度回転することもできます（スコアを1000ポイント増加させます）。

座る最適な場所を見つけるために、近くのキオスクから地図（あなたのパズル入力）を手に入れることから始めます。
例えば：

```
###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############
```

この迷路には多くの経路がありますが、最良の経路のいずれかを選ぶと、スコアはわずか7036になります。
これは、36歩前進し、合計で7回90度回転することで達成できます：

```
###############
#.......#....E#
#.#.###.#.###^#
#.....#.#...#^#
#.###.#####.#^#
#.#.#.......#^#
#.#.#####.###^#
#..>>>>>>>>v#^#
###^#.#####v#^#
#>>^#.....#v#^#
#^#.#.###.#v#^#
#^....#...#v#^#
#^###.#.#.#v#^#
#S..#.....#>>^#
###############
```

二つめの例を示します：

```
#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################
```

この迷路では、最良の経路は11048ポイントかかります。そのような経路のひとつをたどると、次のようになります：

```
#################
#...#...#...#..E#
#.#.#.#.#.#.#.#^#
#.#.#.#...#...#^#
#.#.#.#.###.#.#^#
#>>v#.#.#.....#^#
#^#v#.#.#.#####^#
#^#v..#.#.#>>>>^#
#^#v#####.#^###.#
#^#v#..>>>>^#...#
#^#v###^#####.###
#^#v#>>^#.....#.#
#^#v#^#####.###.#
#^#v#^........#.#
#^#v#^#########.#
#S#>>^..........#
#################
```

上に示した経路には、最初の動きとして90度のターンが含まれており、東を向いていたトナカイが北を向くことになります。

地図を注意深く分析してください。トナカイが得られる可能性のある最小スコアはいくつですか？

# パート2

最良の経路がどのようなものかわかったので、座るのに最適な場所を見つけることができます。

全ての壁でないタイル (`S`, `.`, `E`) には、タイルの端に座る場所が用意されています。
これらのタイルのどれが座るのに最適な場所かを決めるには、
様々な要因（座席の快適さ、トイレの距離、視界を遮る柱の有無など）が影響しますが、
最も重要な要因は、**そのタイルが迷路の最良の経路のいずれかに含まれているかどうか**です。
そうでないどこか別の場所に座ると、すべてのアクションを見逃してしまいます！

したがって、`S` タイルと `E` タイルを含む、
迷路の最良の経路の**いずれか**の一部であるタイルを特定する必要があります。

最初の例では、迷路のさまざまな最良の経路のいずれかに含まれるタイル（`O`でマークされています）が45個あります：

```
###############
#.......#....O#
#.#.###.#.###O#
#.....#.#...#O#
#.###.#####.#O#
#.#.#.......#O#
#.#.#####.###O#
#..OOOOOOOOO#O#
###O#O#####O#O#
#OOO#O....#O#O#
#O#O#O###.#O#O#
#OOOOO#...#O#O#
#O###.#.#.#O#O#
#O..#.....#OOO#
###############
```

ふたつめの例では、少なくとも1つの最良の経路に含まれるタイルが64枚あります：

```
#################
#...#...#...#..O#
#.#.#.#.#.#.#.#O#
#.#.#.#...#...#O#
#.#.#.#.###.#.#O#
#OOO#.#.#.....#O#
#O#O#.#.#.#####O#
#O#O..#.#.#OOOOO#
#O#O#####.#O###O#
#O#O#..OOOOO#OOO#
#O#O###O#####O###
#O#O#OOO#..OOO#.#
#O#O#O#####O###.#
#O#O#OOOOOOO..#.#
#O#O#O#########.#
#O#OOO..........#
#################
```

地図をさらに分析してください。
迷路の最良の経路のいずれかに含まれるタイルは何枚ありますか？
