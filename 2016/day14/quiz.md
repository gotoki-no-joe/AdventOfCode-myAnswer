# 14日目：ワンタイムパッド #

この作戦に参加している間、サンタと安全に通信するために、
事前に合意されたアルゴリズムを使用して生成したワンタイムパッドを使用しています。
残念ながら、ワンタイムパッドのキーを使い果たしたため、さらにいくつかを生成する必要があります。

キーを生成するには、最初に、事前に用意されたソルト（パズル入力）と
1ずつ増加する整数インデックス（0から始まり、10進数で表される）のMD5を取得して、
ランダムデータのストリームを取得します。
結果のMD5ハッシュは、**小文字**の16進数の文字列として表します。

ただし、これらのMD5ハッシュのすべてが**キー**であるとは限らず、
ワンタイムパッドには新しいキーが64個だけ必要です。
ハッシュは、**次の場合にのみ**キーです。

- `777` のように、同じ文字が**3つ**続けて含まれています。ハッシュ内の最初のそのような3つ組のみを考慮してください。
- ストリーム内の次の1000個のハッシュの1つには、`77777` のようにそれと同じ文字が**5回**続けて含まれています。

5つの同じものの並びを探して後続のハッシュを求めることで、それらのハッシュを飛ばしてはいけません。
現在のハッシュがキーであるかどうかに関係なく、常に次のハッシュからキーのテストを再開します。

たとえば、事前に準備されたソルトが`abc`の場合：

- 3つ並びを生成する最初のインデックスは18です。これは`abc18`のMD5ハッシュには`...cc38887a5...`が含まれているためです。
しかし、続く1000個のハッシュ（インデックス19からインデックス1018まで）には`88888`が含まれていないため、
インデックス18はワンタイムパッドのキーには入りません。
- 3つ並びを生成する次のインデックスは39です。`abc39`のハッシュには`eee`が含まれます。
これは最初のキーでもあります。次の1000個のハッシュの1つ（インデックス`816`のハッシュ）には`eeeee`が含まれます。
- 次の6つの3つ並びはどれもキーではありませんが、その次のインデックス92でのトリプルはキーです。
それは`999`を含み、インデックス200は`99999`を含みます。
- 最終的に、インデックス22728は64個めのキーを生成するためのすべての基準を満たします。

したがって、ソルト`abc`を使用する例では、インデックス22728が64個めのキーを生成します。

パズル入力の実際のソルトでは、どのインデックスが64個めのワンタイムパッドのキーを生成しますか？

あなたのパズル入力は`jlmsuwbz`です。

# パート2 #

もちろん、このプロセスをさらに安全にするために、キーストレッチも実装しました。

キーストレッチにより、攻撃者はハッシュの生成により多くの時間を費やす必要があります。
残念ながら、それは他のすべての人にもより多くの時間を費やすことを余儀なくさせます。

キーストレッチを実装するために、あなたはハッシュを生成するたびに、
あなたがそれを使用する前にまず、そのハッシュのMD5ハッシュを求め、**その**ハッシュのMD5ハッシュを求め、
以下同様に**2016回の追加のハッシュ計算**を行います。
常にハッシュの小文字の16進表現を使用してください。

たとえば、インデックス0とソルト`abc`のストレッチハッシュを見つけるには：

- `abc0`のMD5ハッシュ`577571be4de9dcce85a041ba0410f29f`を求めます。
- 次に、そのハッシュのMD5ハッシュ`eec80a0c92dc8a0777c619d9bb51e910`を求めます。
- 次に、そのハッシュのMD5ハッシュ`16062ce768787384c81fe17a7a60c7e3`を求めます。
- ...何度も繰り返す...
- 次に、そのハッシュのMD5ハッシュ`a107ff634856bb300138cac6568c0f24`を求めます。

したがって、この状況でのインデックス0のストレッチハッシュは`a107ff...`です。
結局、元のハッシュ（MD5の1回の使用）を求めてから、
前のハッシュのハッシュを2016回求めて、合計2017回MD5を行います。

プロセスの他の部分は同じままですが、キーは完全に異なります。
再びソルト`abc`を例にとると：

- 最初の3つ並び（`222`、インデックス5）は続く1000個のハッシュで対応する`22222`を持ちません。
- 2番目の3つ並び（`eee`、インデックス10）は、対応する`eeeee`をインデックス89に持つため、最初のキーになります。
（原文hasをhashとtypoしている？）
- 最終的に、インデックス22551が64個めのキーを生成します。（3つ並び`fff`が対応する`fffff`をインデックス22859に持つ。）

パズル入力の実際のソルトを考慮し、キーストレッチのための2016回の追加のMD5呼び出しを使用すると、
どのインデックスが64個めのワンタイムパッドのキーを生成しますか？
