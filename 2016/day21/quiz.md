
# 21日目：スクランブルされた文字とハッシュ #
--- Day 21: Scrambled Letters and Hash ---

侵入しているコンピュータシステムは、奇妙なスクランブル関数を使用してパスワードを保存しています。
独自のスクランブルパスワードを作成してシステムに追加できるようにすることは、それほど問題にはならないはずです。スクランブル関数を実装するだけです。

スクランブル関数は一連の操作からなります。
（正確なリストはパズル入力で提供されます。）
スクランブルしたいパスワードから始めて、各操作を文字列に続けて適用します。
個々の操作は次のように動作します。

- `swap position X with position Y` 位置XとY（0から数えて）の文字を交換する必要があることを意味します。
- `swap letter X with letter Y` 文字XとYを交換する必要があることを意味します（文字列のどこにあるかに関係なく）。
- `rotate left/right X steps` 文字列全体を回転させる必要があることを意味します。例えば、右に1回転させると abcd は dabc になります。
- `rotate based on position of letter X` これは、この命令がローテーションを行う前に決定された文字の位置（0から数えて）に基づいて、文字列全体を右に回転する必要があることを意味します。位置が決定されたら、文字列を右に1回、さらにその位置に等しい回数、さらに位置が4以上の場合はもう1回、右に回転します。
- `reverse positions X through Y` 位置Xから位置Yの範囲（XとYの位置の文字を含む）を逆順にすることを意味します。
- `move position X to position Y` 位置Xにある文字を文字列から削除してから、位置Yになるように挿入する必要があることを意味します。

例えば、abcde から始めて以下の操作を実行するとします。

- `swap position 4 with position 0` 最初と最後の文字を入れ替えて、次のステップの入力 ebcda を生成します。
- `swap letter d with letter b` dとb(の位置)を入れ替えます：edcba
- `reverse positions 0 through 4` 文字列全体が逆になり、 abcde が生成されます。
- `rotate left 1 step` すべての文字を1つ左にずらし、最初の文字を文字列の最後に折り返します：bcdea
- `move position 1 to position 4` 位置1の文字(c)を削除してから、位置4（文字列の終わり）に挿入します：bdeac
- `move position 3 to position 0` 位置3の文字(a)を削除してから、位置0（文字列の先頭）に挿入します：abdec
- `rotate based on position of letter b` 文字bの位置を見つけ(2)、文字列を右に1回、さらにその位置に等しい回数(2)だけ回転します：ecabd
- `rotate based on position of letter d` 文字dの位置を見つけて(4)、文字列を右に1回回転し、さらにその位置に等しい回数に加えて、位置が4以上であるために追加の1回を加えて、合計で6右に回転します：decab

これらの手順の後、結果のスクランブルされたパスワードは decab です。

これで、新しいスクランブルパスワードを生成するだけで、システムにアクセスできます。パズル入力のスクランブル操作のリストを考えると、abcdefgh をスクランブルした結果は何ですか？

# パート2 #

あなたはパスワードを正しくスクランブルしましたが、システムのパスワードファイルを実際に変更することはできないことに気づきました。
スクランブルの処理を逆にして、既存のパスワードの1つをスクランブル解除する必要があります。

スクランブルされたパスワード fbgdceah がスクランブルされる前は何でしたか？
