# 23日目:カニカップ

小さなカニが**あなた**にゲームを挑みます！
カニはいくつかのカップをかき混ぜるので、それらがどこに行き着くかを予測する必要があります。

カップは円形に配置され、**時計回り**にラベルが付けられます（あなたのパズル入力）。
例えば、ラベルが `32415` の場合、5つのカップが丸く並んでいます。
最初のカップから時計回りに進むと、カップには `3`, `2`, `4`, `1`, `5` のラベルが付いており、再び `3` に戻ります。

カニが始める前に、リストの最初のカップを**現在のカップ**として指定します。
その後カニは**100回操作します**。

1**操作**ごとに、カニは次の動作を実行します：

- カニは、**現在のカップ**から**時計回り**にすぐ隣の**3つのカップ**を持ち上げます。
それらは円から取り除かれます。
円を維持するために必要に応じてカップの間隔が調整されます。
- カニは**目標のカップ**を選択します。
現在のカップのラベルから1を引いたものと同じラベルのカップです。
これにより、拾い上げたばかりのカップの1つが選択される場合、
カニは拾い上げたばかりではないカップを見つけるまで1を引き続けます。
このプロセスのいずれかの時点で、値がカップのラベルの最小値を下回った場合、
代わりにカップのラベルの**最大値に戻り**ます。
- カニは、先ほど手に取ったカップを、目的のカップの**時計回りのすぐ次**に置きます。
それらは拾い上げたときと同じ順序を保ちます。
- カニは新しい**現在のカップ**を選択します。現在のカップの時計回りすぐ次のカップです。

例えば、カップのラベルが `389125467` だったとします。
カニがたった10回の操作をすると、次のような変化が起こります：

```
-- move 1 --
cups: (3) 8  9  1  2  5  4  6  7 
pick up: 8, 9, 1
destination: 2

-- move 2 --
cups:  3 (2) 8  9  1  5  4  6  7 
pick up: 8, 9, 1
destination: 7

-- move 3 --
cups:  3  2 (5) 4  6  7  8  9  1 
pick up: 4, 6, 7
destination: 3

-- move 4 --
cups:  7  2  5 (8) 9  1  3  4  6 
pick up: 9, 1, 3
destination: 7

-- move 5 --
cups:  3  2  5  8 (4) 6  7  9  1 
pick up: 6, 7, 9
destination: 3

-- move 6 --
cups:  9  2  5  8  4 (1) 3  6  7 
pick up: 3, 6, 7
destination: 9

-- move 7 --
cups:  7  2  5  8  4  1 (9) 3  6 
pick up: 3, 6, 7
destination: 8

-- move 8 --
cups:  8  3  6  7  4  1  9 (2) 5 
pick up: 5, 8, 3
destination: 1

-- move 9 --
cups:  7  4  1  5  8  3  9  2 (6)
pick up: 7, 4, 1
destination: 5

-- move 10 --
cups: (5) 7  4  1  8  3  9  2  6 
pick up: 7, 4, 1
destination: 3

-- final --
cups:  5 (8) 3  7  4  1  9  2  6 
```

上の例では、カップの値は、時計回りに移動して見えるラベルです。
**現在のカップ**は()で印されています。

カニがやり終わった後、カップはどんな順序になりますか？
**1とラベル付けされたカップの後**から始めて、
他のカップのラベルを時計回りに集めて、余分な文字を含まないひとつの文字列にします。
1以外の番号がちょうど1回ずつ現れます。
上の例では、10回の操作の後、1から時計回りにカップのラベルは 9, 2, 6, 5, となっており、92658374が生成されます。
カニが100手全てを完了した場合、カップ1の後の順は67384529になります。

あなたのラベル順で、100回の操作をシミュレートします。
カップ1の後のカップのラベルは何ですか？

# パート2

誤訳があったとしか思えません（実際あなたはカニ語は堪能ではありません）。
カニがあなたのいかだの上に円を描くように**たくさんの**カップ、
合計**100万**個(1000000)を並べ始めたので、あなたはとても驚きました。

最初の数個のカップのラベルはまだ正しいです。
その後、残りのカップには、リスト内の最も高い番号の次の番号から始まり、
100万に達するまで1つずつ順番に番号が付けられます。
（例えば、ラベルが `54321` の場合、カップには `5`, `4`, `3`, `2`, `1` の番号が付けられ、
さらに6から数え上げて100万に達するまで続けます。）
このようにして、1から100万までの全ての数値がちょうど1回使用されます。

（訳註：例の場合 `3,8,9,1,2,5,4,6,7, 10, 11, 12, 13, …, 999998, 999999, 1000000]` となる、ということ。）

カニの数を翻訳する際にどこで間違いを犯したかを発見した後、
小さなカニはたった100回の操作をするのではないことに気づきました。
カニは**1,000万**回(10000000)の操作をするつもりです！

カニは、**最後にカップ1の時計回りにすぐ隣の2つのカップ**の下に、それぞれ1つずつあなたの**星**を隠します。
カニが終わったときに、それらのカップのラベルを予測すれば、それらを手に入れることができます。

上の例(389125467)では、これは934001と159792になります。
これらを掛け合わせると149245887792になります。

最終的にカップ1の時計回りすぐ隣に来るつのカップを見つけます。
それらのラベルを掛け合わせるといくつになりますか？
