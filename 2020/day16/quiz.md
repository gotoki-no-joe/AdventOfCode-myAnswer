# 16日目：切符の翻訳 #

さらに別の乗り継ぎ便に向かって歩いていると、
ルート変更された旅行の一行程が高速列車になっていることに気付きました。
しかし、あなたが受け取った列車の切符はあなたが理解できない言語で書かれています。
次のフライトの後で駅に着く前に、それが何を言っているかを理解する必要がおそらくあるでしょう。

残念ながら、切符にある言葉を**読む**ことは実際できません。
ただし、数字は読むことができたため、
あなたは**切符に書かれているはずの項目**と、
それぞれの項目について**値の正しい範囲**を把握することができました。

**切符の項目に関する規則**、**自分の切符にある数字**、
そして同じ列車に乗る他の人の近くにある**他の切符にある数字**
（これは空港の防犯カメラを利用しました）
を1つの文書にまとめて参照できるようにしました。（あなたのパズル入力）

**切符の項目に関する規則**は、切符の**どこか**に存在する項目の一覧と、
それぞれの項目について**値の正しい範囲**を定めています。
たとえば、`class: 1-3 or 5-7`のような規則は、
すべての切符にある項目のいずれか一つが`class`という名前で、
1から3と5から7の範囲の任意の値になれることを意味します。
（端を含むので、3と5はこの項目の値として正しいが、4は正しくない。）

一枚の切符は、コンマで区切られた値の一行で表されます。
値は切符にある数字で、書いてある順です。
すべての切符は同じ形式です。
たとえば、次のチケットについて考えてみます。

~~~
.--------------------------------------------------------.
| ????: 101    ?????: 102   ??????????: 103     ???: 104 |
|                                                        |
| ??: 301  ??: 302             ???????: 303      ??????? |
| ??: 401  ??: 402           ???? ????: 403    ????????? |
'--------------------------------------------------------'
~~~

ここで、`?`はあなたが理解できない言語の活字を表します。
この切符は`101,102,103,104,301,302,303,401,402,403`のように表されます。
もちろん、あなたが見ている実際の列車の切符はこれよりもっと**ずっと**複雑です。
いずれにせよ、
最初の数字が常に同じ特定の欄のものであり、
2番目の数字が別の常に同じ特定の欄のものであり、
…というやり方で数字だけを抽出しました。
それぞれの位置が実際に何を意味するかだけがわかりません！

どの切符が**完全に無効**であるかを判別することから始めます。
それは、**どの欄としても正しくない**値を含む切符です。
今のところあなたの切符は無視してください。

たとえば、次のメモがあるとします。

~~~
class: 1-3 or 5-7
row: 6-11 or 33-44
seat: 13-40 or 45-50

your ticket:
7,1,14

nearby tickets:
7,3,47
40,4,50
55,2,20
38,6,12
~~~

どの位置がどの欄に対応するかは関係ありません。
切符に**どの欄としても正しくない値**が書かれているかどうかのみを考えて、
**近くにある切符**のうち無効なものを判別できます。
この例では、1枚めの**近くの切符**の値はすべて、少なくとも1つの欄に関して正しいです。
これは、他の3枚の**近くの切符**については成り立ちません。
値4,55,12はどの欄としても正しくありません。
すべての無効な値を合計すると、**切符スキャンエラー率**が求められます。
この例では 4 + 55 + 12 = 71 となります。

スキャンした**近くの切符**の有効性を調べてください。
**あなたの切符スキャンエラー率はいくつですか？**

# パート2 #

無効な値が含まれている切符を特定できたので、**それらの切符のデータを完全に破棄してください。**
残りの有効な切符を使用して、どの欄がどれであるかを判別します。

それぞれの欄の正しい範囲を使用して、切符にそれぞれの欄が現れる順序を決定します。
順序はすべての切符で一貫しています。
`seat`が3番目の欄の場合、**あなたの切符**を含むすべての切符の3番目の欄は`seat`です。

たとえば、次のメモがあるとします。

~~~
class: 0-1 or 4-19
row: 0-5 or 8-19
seat: 0-13 or 16-19

your ticket:
11,12,13

nearby tickets:
3,9,18
15,1,5
5,14,9
~~~

上記の例の**近くの切符**に基づいて、最初の位置は`row`、2番目の位置は`class`、3番目の位置は`seat`とわかります。
**あなたの切符**では`class`は12、`row`は11、`seat`は13と結論づけることができます。

どの欄がどれであるかがわかったら、
**あなたの切符**で`departure`という単語で始まる6つの欄を探します。
**これらの6つの値を掛け合わせるといくつですか？**
