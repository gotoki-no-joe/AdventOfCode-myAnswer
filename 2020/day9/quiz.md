# 9日目：エンコードエラー #

隣の席の子供たちは携帯ゲーム機で遊んでいるので、
座席の目の前にある小さな画面にあるデータ端子に注意を向けます。

端子は​​標準規格ではないものですが、いくつかのペーパークリップを巧みに使用して、ポートをコンピュータに接続できました。
接続すると、ポートは一連の数値（パズル入力）を出力しました。

データは、eXchange-Masking Addition System（XMAS）で暗号化されているように見えます。
これは、おあつらえ向きなことに、重要な弱点を持つ古い暗号です。

XMASは、25個の数からなる**プリアンブル**を送信することから始まります。
その後、受け取る各数値は、直前の25個の数値のうちのいずれか2つの合計になります。
その2つの数値は異なる値でなくてはならず、またそのようなペアが複数存在することは許されます。

たとえば、あなたのプリアンブルが1から25の数のランダムな並びで構成されていたとします。
次の数値が有効なものであるためには、これらの数値の2つの合計である必要があります。

- `26`は**有効**な数です。それは1+25（または2と24のような他の多くのペア）だからです。
- `49`は24と25の合計であるため、**有効**な次の数値になります。
- `100`は有効では**ありません**。前の25個の数のどの2つを合計してもになることはありません。
- `50`もまた有効では**ありません**。前の25個の数には25が入っていますが、ペアの2つの数は異なっている必要があります。

26番目の数値が45であり、先頭の数値（25個よりも前になるため、選択肢から外れる）が20であったとします。
ここで、次の数値が有効なものであるためには、
1～19, 21～25, 45 の数の中からふたつ足し合わせてその数になるようなペアが必要です。

- `26`は1と25がまだ前25個の数の内にあるため、引き続き**有効**な次の数になります。
- `65`は、利用可能な数値の2つ数で合計がそれになるものがないため、有効では**ありません**。
- `64`と`66`はそれぞれ19+45と21+45の結果であるため、両方とも**有効**です。

直前**5つ**の数値のみを考慮した（そして長さ5のプリアンプルを持つ）より大きな例を示します。

~~~
35
20
15
25
47
40
62
55
65
95
102
117
150
182
127
219
299
277
309
576
~~~

この例では、5つの数のプリアンプルの後、ほぼすべての数は前の5つの数のうち2つの合計です。
この規則に従わない唯一の数は**127**です。

XMASデータの脆弱性を攻撃する最初のステップは、
その前の25個の数のうちの2つの合計では**ない**ような
（プリアンプルより後の）最初の数を見つけることです。
（訳注：つまり、**有効**でない最初の数）
**この性質を持たない最初の数は何ですか？**

# パート2 #

XMAS暗号を破る最後のステップは、あなたが今見つけた**有効でない**数に依存します。
リストの中から、**長さ2以上の連続した部分**で、
その合計がステップ1で得た有効でない数となるものを見つける必要があります。

上記の例をもう一度考えてみましょう。

~~~
35
20
15 *
25 *
47 *
40 *
62
55
65
95
102
117
150
182
127
219
299
277
309
576
~~~

このリストでは、15から40の数のすべてを足すことにより、ステップ1で得た有効でない数127が得られます。
（もちろん、実際のリストの連続する数の列ははるかに長くなる可能性があります。）

**暗号の脆弱性**を見つけるには、この連続した範囲の数の**最小値**と**最大値**を足し合わせます。
この例では、これらは15と47で、足すと62です。

**あなたのXMAS暗号化された数値リストの暗号の脆弱性はいくつですか？**
