# 8日目：メモリ操作 #

そりはその重さからあなたが想像したよりも簡単に引っ張ることができました。
残念なことに、あなたも妖精も、北極がここからどの方向にあるのか知りません。

あなたは何か助けになるかと手首の装置をチェックします。
それは何らかの種類のナビゲーションシステムを持っているようです！
ナビゲーションシステムを起動すると、さらに悪いニュースが発生しました。
「ナビゲーションシステムの起動に失敗しました。
ソフトウェアライセンスファイルが読み込めません。」

ナビゲーションシステムのライセンスファイルは、
数字のリスト（パズル入力）で構成されています。
数値は、
処理することでライセンス番号を計算するために使用できる
ある種の**木**を生成するデータ構造を定義します。

**木**は**ノード**で構成されます。
最も外側の唯一のノードが木の**根**をなし、
それは木の他のすべてのノードを含んでいます。
（あるいは、ノードを含むノードを含み、が繰り返されます。）

具体的には、ノードは以下のものから構成されます。

- **ヘッダ**は常にちょうど2つの数です。
  - 子ノードの数
  - メタデータエントリの数
- ゼロ個以上の**子ノード**（ヘッダーで指定されているだけ）
- 1つ以上の**メタデータエントリ**（ヘッダーで指定されているだけ）

それぞれの子ノード自体は、
それ自身のヘッダ、子ノード、メタデータを持つノードです。例えば：

~~~
2 3 0 3 10 11 12 1 1 0 1 99 2 1 1 2
A----------------------------------
    B----------- C-----------
                     D-----
~~~

この例では、ツリーの各ノードは、簡単に識別できるように
文字で始まる下線を付けています。
その中には4つのノードがあります。

- `A` これは`2`つの子ノード(`B`,`C`)を持ち、
`3`つのメタデータエントリ(`1`,`1`,`2`)を持ちます。
- `B` これは`0`個の子ノードと
`3`つのメタデータエントリ(`10`,`11`,`12`)を用います。
- `C` は`1`つの子ノード(`D`)と`1`メタデータエントリ(`2`)を持ちます。
- `D` は`0`個の子ノードと1メタデータエントリ(`99`)を持ちます。

ライセンスファイルで行われる最初のチェックは、
すべてのメタデータエントリを単に足し合わせることです。
この例では、その合計は$1+1+2+10+11+12+2+99=138$です。

**すべてのメタデータエントリの合計はいくらですか？**

# パート2 #

ふたつめのチェックは少し複雑です。
根ノード（上記の例では`A`）の値を見つける必要があります。

**ノードの値**は、子ノードを持つかどうかによって異なります。

ノードに**子ノードがない**場合、
その値はそのメタデータエントリの合計です。
よって、ノード`B`の値は$10+11+12=33$であり、
ノード`D`の値は99です。

しかし、ノードに**子ノードがある**場合は、
メタデータエントリはその子ノードを参照するインデックスになります。
メタデータエントリ`1`は最初の子ノードを指し、
`2`は2番目の子ノード、`3`は3番目の子ノード、以下同様となります。
このノードの値は、
メタデータエントリによって参照される子ノードの値の合計です。
参照された子ノードが存在しない場合、その参照はスキップされます。
子ノードは複数回参照されることもあり、参照されるたびにカウントされます。
メタデータエントリ0は子ノードを参照しません。

たとえば、上記の木を再度使用すると次のようになります。

- ノード`C`には1つのメタデータエントリ`2`があります。
ノード`C`には子ノードが1つしかないため、
`2`は存在しない子ノードを参照しており、ノード`C`の値は0です。
- ノード`A`は3つのメタデータエントリ`1`,`1`,`2`を持っています。
`1`はノード`A`の最初の子ノード`B`を参照し、
`2`は`A`の2番目の子ノード`C`を参照します。
ノード`B`は値33を持ち、
ノード`C`は値0を持つため、
ノード`A`の値は$33+33+0=66$です。

よってこの例では、根ノードの値は66です。

**根ノードの値は何ですか？**
