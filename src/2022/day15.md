# 15 日目: ビーコン除外領域

あなたが遭難信号に導かれて地下トンネルの広大な迷宮に足を踏み入れたとき、再び地面が鳴り響くのを感じます。
それらを全て調べる時間はありませんが、調べる必要もありません。
あなたのリュックには、
元は行方不明になった小人を見つけるために作られたらしい、
散開させることができる**センサー**のセットが入っています。

センサーはそれほど強力ではありませんが、問題ありません。
あなたの携帯機器は、遭難信号の発信源に十分に、
センサーシステムが有効な距離まで近づいていることを示しています。
リュックから緊急センサーシステムを取り出し、上部にある大きなボタンを押すと、
センサー群がトンネル内各所へ高速に展開されます。

センサーは、適切な読み取りができると思われる地点を見つけると、
固い表面に自身を固定し、最も近い信号源**ビーコン**の監視を開始します。
センサーとビーコンは常に整数座標に存在します。
各センサーは自分の位置を認識しており、**ビーコンの位置を正確に特定**できます。
ただし、センサーは、マンハッタン距離[pedia]で測って
**センサーに最も近い**ビーコンひとつにしかロックオンできません。
（2つのビーコンからセンサーまでの距離が同じになることはありません。）

センサーが自身の位置と最も近いビーコンを報告するのにそれほど時間はかかりません。
（パズルの入力）
例えば：

```
Sensor at x=2, y=18: closest beacon is at x=-2, y=15
Sensor at x=9, y=16: closest beacon is at x=10, y=16
Sensor at x=13, y=2: closest beacon is at x=15, y=3
Sensor at x=12, y=14: closest beacon is at x=10, y=16
Sensor at x=10, y=20: closest beacon is at x=10, y=16
Sensor at x=14, y=17: closest beacon is at x=10, y=16
Sensor at x=8, y=7: closest beacon is at x=2, y=10
Sensor at x=2, y=0: closest beacon is at x=2, y=10
Sensor at x=0, y=11: closest beacon is at x=2, y=10
Sensor at x=20, y=14: closest beacon is at x=25, y=17
Sensor at x=17, y=20: closest beacon is at x=21, y=22
Sensor at x=16, y=7: closest beacon is at x=15, y=3
Sensor at x=14, y=3: closest beacon is at x=15, y=3
Sensor at x=20, y=1: closest beacon is at x=15, y=3
```

さて、位置`2,18`のセンサーを考えてみましょう。
それに最も近いビーコンは`-2,15`にあります。
`9,16`にあるのセンサーに対して、それに最も近いビーコンは`10,16`にあります。

センサーを`S`、ビーコンを`B`として描画すると、
上記のセンサーとビーコンの配置は次のようになります。

```
               1    1    2    2
     0    5    0    5    0    5
 0 ....S.......................
 1 ......................S.....
 2 ...............S............
 3 ................SB..........
 4 ............................
 5 ............................
 6 ............................
 7 ..........S.......S.........
 8 ............................
 9 ............................
10 ....B.......................
11 ..S.........................
12 ............................
13 ............................
14 ..............S.......S.....
15 B...........................
16 ...........SB...............
17 ................S..........B
18 ....S.......................
19 ............................
20 ............S......S........
21 ............................
22 .......................B....
```

ただし、これは必ずしもエリア内の全てのビーコンの包括的な地図ではありません。
各センサーは最も近いビーコンのみを識別するため、
センサーがビーコンを検出したとき、そのセンサーからその距離またはより近い位置に他のビーコンがないことがわかります。
たまたま、どのセンサーに対しても最も近いビーコンではないビーコンがまだ存在する可能性があります。
`8,7` のセンサーを考えてみましょう：

```
               1    1    2    2
     0    5    0    5    0    5
-2 ..........#.................
-1 .........###................
 0 ....S...#####...............
 1 .......#######........S.....
 2 ......#########S............
 3 .....###########SB..........
 4 ....#############...........
 5 ...###############..........
 6 ..#################.........
 7 .#########S#######S#........
 8 ..#################.........
 9 ...###############..........
10 ....B############...........
11 ..S..###########............
12 ......#########.............
13 .......#######..............
14 ........#####.S.......S.....
15 B........###................
16 ..........#SB...............
17 ................S..........B
18 ....S.......................
19 ............................
20 ............S......S........
21 ............................
22 .......................B....
```

このセンサーに最も近いビーコンは `2,10` にあるため、
その距離またはより近い位置（`#` とマークされた位置）にはビーコンがないことがわかります。

検出されたビーコンはいずれも遭難信号を生成していないようです。
そのため、遭難ビーコンがどこに**ない**かを調べる必要があります。
ここでは、話を単純にするために、
ある1列の中で、ビーコンが存在する可能性のない位置を数えることにします。

そこで、上記の例のようなビーコンとセンサーの配置があり、
`y=10` の行について、ビーコンが存在する可能性のない位置を数えたいとします。
その行の近くにあるすべてのセンサーが覆っている領域は次のようになります。

```
                 1    1    2    2
       0    5    0    5    0    5
 9 ...#########################...
10 ..####B######################..
11 .###S#############.###########.
```

この例では、`y=10` の行に、ビーコンが存在できない位置が `26` 箇所あります。
先ほどあなたが発進させたセンサーからの報告を参照してください。
**`y=2000000` の行で、ビーコンが存在しえない位置はいくつありますか？**

<!--
<details><summary>解説</summary><div>

```haskell
```

</div></details>
-->

# パート2

あなたの携帯機器は、付近のビーコンから遭難信号が発信されていることを示しています。
どのセンサーも遭難ビーコンを検出していませんが、
遭難ビーコンの`x,y`座標はどちらも`0`より小さくなく`4000000`より大きくないことは確実です。

遭難ビーコンの信号を抽出するには、**同調周波数**を決定する必要があります。
これは、その `x` 座標に `4000000` を掛けてから、その `y` 座標を加算することによって得られます。

上記の例では、探索空間はもっと小さくなっています。`x`と`y`の座標はどちらも最大`20`です。
この縮小された検索領域では、ビーコンが存在しうる位置は `x=14, y=11` の一か所だけです。
この遭難ビーコンの同調周波数は `56000011` です。

遭難ビーコンの存在可能な唯一の位置を見つけてください。
**その同調周波数はいくつですか？**

<!--
<details><summary>解説</summary><div>

```haskell
```

</div></details>
-->
