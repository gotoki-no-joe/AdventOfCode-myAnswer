# 9日目：電脳空間での爆発

セキュアなエリアを回ると、ネットワークの新しい部分に繋がるデータリンクポートを見つけました。
簡単にスキャンして興味のあるファイルを探した後、
特にあなたの注意を喚起するファイルが1つ見つかりました。
それは実験的なフォーマットで圧縮されていますが、
幸いなことに、フォーマットのドキュメントが近くにあります。

このフォーマットは文字の列を圧縮します。空白は無視されます。
何らかの列を繰り返す必要を表すために、
`(10x2)`のような形でファイルにマーカーが追加されます。
このマーカーを伸張するには、後続の10文字を取り出して2回繰り返します。
その後、繰り返したデータの後に続くファイルを読み込み続けます。
マーカー自体は、伸張された出力には含まれません。
<!-- decompress 解凍は間違いだが、圧縮解除も長い。-->

マーカーで参照されるデータ内にかっこやその他の文字が現れても問題ありません。
マーカーとしてではなく通常のデータとして扱い、
伸張した部分の先でマーカー探しに戻ります。

例えば：

- `ADVENT` はマーカーを含まないので、
変更なしでそれ自身に伸張され、伸張された結果の長さは6になります。
- `A(1x5)BC` は`B`だけを5回繰り返し
`ABBBBBC`となり、伸張された長さは7になります。
- `(3x3)XYZ` は`XYZXYZXYZ`となり伸張された長さは9になります。
- `A(2x2)BCD(2x2)EFG` は`BC`と`EF`を二重にし
`ABCBCDEFEFG`となり、伸張された長さは11になります。
- `(6x1)(1x3)A` は単に`(1x3)A`となります。
`(1x3)`はマーカーのように見えますが、
別のマーカーのデータセクション内にあるため、
その後にある`A`と扱いに違いはありません。
伸張された長さは6になります。
- `X(8x2)(3x3)ABCY` は`X(3x3)ABC(3x3)ABCY`となり、
伸張された長さは18になります。
というのは、
`(8x2)`のマーカーにより伸張されたデータ`(3x3)ABC`は
読み飛ばされ、さらに処理されることはありません。

そのファイル（あなたのパズル入力）の
**伸張された長さ**はいくつですか？
空白を数えないでください。

# パート2 #

どうやら、ファイルは実際には**バージョン2**のフォーマットを使用しています。

バージョン2では、唯一の違いは、
伸張されたデータ内のマーカーが**伸張される**ことです。
これは、ドキュメントで説明されているように、
より大きな圧縮能力を提供し、
数ギガバイトのファイルをわずか数キロバイトで保存できるようにします。

例えば：

- `(3x3)XYZ` は伸張されたセクションにはマーカーが含まれていないので、
従来通り`XYZXYZXYZ`となります。
- `X(8x2)(3x3)ABCY` は`XABCABCABCABCABCABCY`となります。
これは、`(8x2)`マーカーにより伸張されたデータがさらに伸張されるためで、
よって`(3x3)`マーカーが2度起動され、合計6つの`ABC`の列になります。
- `(27x12)(20x12)(13x14)(7x10)(1x12)A` は
`A`を241920回繰り返す文字列に伸張されます。
- `(25x3)(3x3)ABC(2x3)XY(5x2)PQRSTX(18x9)(3x2)TWO(5x7)SEVEN` は
445文字の長さに伸張されます。

残念ながら、あなたが持ってきたコンピュータには
このファイルを実際に伸張するだけの充分なメモリがありません。
伸張された長さを得る**別の方法**を思いつく必要があります。

この改善された形式を使用したときのファイルの**伸張された長さ**はいくつですか？
