# 10日目：構文得点 #

あなたは潜水艦に深海の洞窟から抜ける最良の航路を導くように指示します。
しかし潜水艦は次のように返しただけです：

```
Syntax error in navigation subsystem on line: all of them
（ナビゲーションシステムの次の行で構文エラー：全ての行）
```

**全ての行？！**
被害は予想よりひどいようです。
ナビゲーションシステムのコピーを取り出しました（パズル入力）。

ナビゲーションシステムの構文は、複数の行からなり、1行は任意個の**チャンク**でできています。
各行に1つ以上のチャンクがあり、チャンクには0個以上の他のチャンクが含まれています。
隣接するチャンクの間に区切り文字はありません。
つまり、1つのチャンクが終わると、次のチャンク（存在するならば）がすぐに開始されます。
すべてのチャンクは、以下の4つの正しく対応する文字の対のいずれかで
**開始**し**終了**する必要があります。

- チャンクがで `(` で始まる場合は、 `)` で終わる必要があります。
- チャンクがで `[` で始まる場合は、 `]` で終わる必要があります。
- チャンクがで `{` で始まる場合は、 `}` で終わる必要があります。
- チャンクがで `<` で始まる場合は、 `>` で終わる必要があります。

したがって、`()` は他のチャンクを含まない正しいチャンクです。`[]`もそうです。
より複雑な正しいチャンクの例には
`([])`, `{()()()}`, `<([{}])>`, `[<>({}){}[([])<>]]`, `(((((((((())))))))))` があります。

一部の行は**不完全**で、それ以外の行は**破損**しています。
（訳注：問題ない行もあります。）
まずは、破損した行を見つけて破棄しましょう。

破損した行とは、**間違った文字で終わる**チャンクを持つ行です。
つまり、チャンクを開始したり終了したりする際の文字が、
上記の4つの正しい対のいずれにも当てはまらない場合です。

破損したチャンクの例としては、
`(]`, `{()()()>`, `(((()))}`, `<([]){()}[{}])` などがあります。
このようなチャンクは行内のどこにでも現れる可能性があり、
その存在は行全体を破損していると見なす理由となります。

たとえば、次のナビゲーションシステムについて考えてみます。

```
[({(<(())[]>[[{[]{<()<>>
[(()[<>])]({[<{<<[]>>(
{([(<{}[<>[]}>{[]{[(<()>
(((({<>}<{<{<>}{[]{[]{}
[[<[([]))<([[{}[[()]]]
[{[{({}]{}}([{[{{{}}([]
{<[[]]>}<{[{[{[]{()[[[]
[<(<(<(<{}))><([]([]()
<{([([[(<>()){}]>(<<{{
<{([{{}}[<[[[<>{}]]]>[]]
```

一部の行は破損しておらず、不完全です。
今のところ、これらの行は無視してかまいません。
残りの5行は破損しています。

- `{([(<{}[<>[]}>{[]{[(<()>` ― `]` が必要ですが、`}` が見つかりました。
- `[[<[([]))<([[{}[[()]]]` ― `]` が必要ですが、`)` が見つかりました。
- `[{[{({}]{}}([{[{{{}}([]` ― `)` が必要ですが、`]` が見つかりました。
- `[<(<(<(<{}))><([]([]()` ― `>` が必要ですが、`)` が見つかりました。
- `<{([([[(<>()){}]>(<<{{` ― `]` が必要ですが、`>` が見つかりました。

破損したそれぞれの行の最初の間違った終了文字で停止してください。

構文チェッカーたちが、ファイル内の構文エラーのハイスコアを競うコンテストをしていることをご存知ですか？
本当なんです！
ある行の構文エラー得点を計算するには、その行の**最初の不正な文字**で、次の表をひきます。

- `)` ：3点
- `]` ：57点
- `}` ：1197点
- `>` ：25137点

上の例では、不正な `)` が2回（2*3 = 6点）、不正な `]` が1回（57点）、
不正な `}` が1回（1197点）、不正な `>` が1回（25137点）見つかりました。
したがって、このファイルの構文エラーの合計得点は 6+57+1197+25137 = 26397 点です！

ナビゲーションシステムの破損した各行で最初の不正な文字を見つけてください。
**それらのエラーの構文エラー得点の合計はいくつですか？**

# パート2 #

ここで、破損した行を破棄します。残りの行は**不完全**です。

不完全な行には誤った文字は含まれていません。
代わりに、行の終わりにいくつかの終了文字が足りません。
ナビゲーションシステムを修復するには、
行内のすべての開始しているチャンクを**終了させる文字の列**を見つける必要があります。

あなたは終了文字（`)`, `]`, `}`, `>`）だけを使うことができ、
正しい対のみが作られて全てのチャンクが終了するような
正しい順序で終了文字を付け加える必要があります。

上の例では、5つの不完全な行があります。

- `[({(<(())[]>[[{[]{<()<>>` ― `}}]])})]` を追加して完成させます。
- `[(()[<>])]({[<{<<[]>>(` ― `)}>]})` を追加して完成させます。
- `(((({<>}<{<{<>}{[]{[]{}` ― `}}>}>))))` を追加して完成させます。
- `{<[[]]>}<{[{[{[]{()[[[]` ― `]]}}]}]}>` を追加して完成させます。
- `<{([{{}}[<[[[<>{}]]]>[]]` ― `])}>` を追加して完成させます。

オートコンプリートツール**もまた**コンテストをしていることをご存知ですか？
それは本当です！
得点は、補完した文字列を1文字ずつ考慮して決定されます。
合計得点0から始めます。
次に、各文字について、合計得点に5を掛けてから、次の表で文字に与えられる得点値で合計得点を増やします。

- `)`：1点
- `]`：2点
- `}`：3点
- `>`：4点

したがって、上記の最後の補完文字列 `])}>` の得点は次のようにして求められます。

- 合計得点0から始めます。
- 合計得点に5を掛けて0を得て、次に `]` の値 (2) の値を加えて、新しい合計得点2を得ます。
- 合計得点に5を掛けて10を得て、次に `)` の値 (1) の値を加えて、新しい合計得点11を得ます。
- 合計得点に5を掛けて55を得て、次に `}` の値 (3) の値を加えて、新しい合計得点58を得ます。
- 合計得点に5を掛けて290を得て、次に `>` の値 (4) の値を加えて、新しい合計得点2を得ます。

5行の補完文字列の合計得点は次のとおりです。

- `}}]])})]` 合計288957点
- `)}>]})` 合計5566点
- `}}>}>))))` 合計1480781点
- `]]}}]}]}>` 合計995444点
- `])}>` 合計294点

オートコンプリートツールはおかしな連中です。
勝者は、すべての得点を**整列**したときの**中央**の得点により決められます。
（考慮すべき得点は常に奇数個になります。）
この例では、中央の得点は288957です。
つまり、これより小さいものとこれより大きいものが同じ個数だけあります。

不完全な各行に対する補完文字列を見つけ、補完文字列の得点を求め、得点を整列します。
**中央の得点は何ですか？**
