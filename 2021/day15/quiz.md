# 15日目：ヒザラガイ #

洞窟の出口に近づいていますが、壁が迫ってきました。
まだ辛うじてあなたの潜水艦は収まってはいます。
とはいえ、主な問題は、洞窟の壁が[ヒザラガイ](https://ja.wikipedia.org/wiki/%E5%A4%9A%E6%9D%BF%E7%B6%B1)で覆われていることで、
それらにぶつからないようにするべきでしょう。

洞窟は大きいですが、天井が非常に低く、動きが2次元に制限されています。
洞窟の形は正方形に似ています。
カイの密度を高速スキャンして、
洞窟全体の**リスクレベル**のマップを作成しました（パズルの入力）。
例えば：

```
1163751742
1381373672
2136511328
3694931569
7463417111
1319128137
1359912421
3125421639
1293138521
2311944581
```

左上の位置から出発し、目的地は右下の位置で、斜めに移動することはできません。
各位置の数字はそこの**リスクレベル**です。
経路全体の総リスクは、あなたが**進入**するすべての位置のリスクレベルの合計です。
（これは、出発点のリスクレベルは計算に入らないということです、もう一度そこに進入しない限り。
ある位置から出ていくことはリスクレベルを上昇させません。）

あなたの目標は、**総リスクが最も低い**経路を見つけることです。
この例において、総リスクが最も低い経路を（原文では強調表示で）示します。

```
1_________
1_________
2136511___
______15__
_______1__
_______13_
________2_
________3_
________21
_________1
```

このパスの合計リスクは40です。
（出発点には進入しないため、そのリスクは数えません。）

**左上から右下への経路の総リスクの最小値はいくつですか？**

# パート2 #

洞窟の中の危険性の低い道を見つける方法がわかったので、
あなたは脱出経路を見つけることを試みることができます。

洞窟全体は、当初の想定よりも実際には**縦軸と横軸の両方で5倍大きい**です。
最初にスキャンした領域は、完全なマップを形成する5x5タイル領域の1つのタイルにすぎません。
元のマップタイルは右方向と下方向に繰り返されます。
タイルが右または下に繰り返されるたびに、
そのリスクレベルはすべて、タイルのすぐ上または左のタイルよりも**1高く**なります。
ただし、9を超えたリスクレベルは1に戻ります。
したがって、もし元のマップにリスクレベルが8の位置があったとすると、
合計25個のタイルのそれぞれで同じ位置は次のようになります。

```
8 9 1 2 3
9 1 2 3 4
1 2 3 4 5
2 3 4 5 6
3 4 5 6 7
```

上記の1桁のそれぞれの数字は、左上のタイルで8がある位置の例に対応しています。
完全なマップは実際には縦横両方について5倍大きいため、
その位置は合計25回現れ、タイルが複製されるごとに、上に示した値が入ります。

上の最初の例の5倍の大きさの完全な版を示します。
（原文では左上隅の元のマップが強調表示されています。）

```
11637517422274862853338597396444961841755517295286
13813736722492484783351359589446246169155735727126
21365113283247622439435873354154698446526571955763
36949315694715142671582625378269373648937148475914
74634171118574528222968563933317967414442817852555
13191281372421239248353234135946434524615754563572
13599124212461123532357223464346833457545794456865
31254216394236532741534764385264587549637569865174
12931385212314249632342535174345364628545647573965
23119445813422155692453326671356443778246755488935
22748628533385973964449618417555172952866628316397
24924847833513595894462461691557357271266846838237
32476224394358733541546984465265719557637682166874
47151426715826253782693736489371484759148259586125
85745282229685639333179674144428178525553928963666
24212392483532341359464345246157545635726865674683
24611235323572234643468334575457944568656815567976
42365327415347643852645875496375698651748671976285
23142496323425351743453646285456475739656758684176
34221556924533266713564437782467554889357866599146
33859739644496184175551729528666283163977739427418
35135958944624616915573572712668468382377957949348
43587335415469844652657195576376821668748793277985
58262537826937364893714847591482595861259361697236
96856393331796741444281785255539289636664139174777
35323413594643452461575456357268656746837976785794
35722346434683345754579445686568155679767926678187
53476438526458754963756986517486719762859782187396
34253517434536462854564757396567586841767869795287
45332667135644377824675548893578665991468977611257
44961841755517295286662831639777394274188841538529
46246169155735727126684683823779579493488168151459
54698446526571955763768216687487932779859814388196
69373648937148475914825958612593616972361472718347
17967414442817852555392896366641391747775241285888
46434524615754563572686567468379767857948187896815
46833457545794456865681556797679266781878137789298
64587549637569865174867197628597821873961893298417
45364628545647573965675868417678697952878971816398
56443778246755488935786659914689776112579188722368
55172952866628316397773942741888415385299952649631
57357271266846838237795794934881681514599279262561
65719557637682166874879327798598143881961925499217
71484759148259586125936169723614727183472583829458
28178525553928963666413917477752412858886352396999
57545635726865674683797678579481878968159298917926
57944568656815567976792667818781377892989248891319
75698651748671976285978218739618932984172914319528
56475739656758684176786979528789718163989182927419
67554889357866599146897761125791887223681299833479
```

完全なマップがあれば、
合計リスクが最も低い左上隅から右下隅までの経路を見つけることができます。

```
1_________________________________________________
1_________________________________________________
2_________________________________________________
3_________________________________________________
7_________________________________________________
1_________________________________________________
1_________________________________________________
3_________________________________________________
1_________________________________________________
2_________________________________________________
2_________________________________________________
2_________________________________________________
324_______________________________________________
__15______________________________________________
___4______________________________________________
___1______________________________________________
___1123532________________________________________
_________1________________________________________
_________2342_____________________________________
____________332___________________________________
______________1___________________________________
______________61__________________________________
_______________44_________________________________
________________4_________________________________
________________1_________________________________
________________2461______________________________
___________________4______________________________
___________________3______________________________
___________________4564___________________________
______________________554_________________________
________________________3163______________________
___________________________2______________________
___________________________8______________________
___________________________125____________________
_____________________________6413_________________
________________________________7_________________
________________________________26________________
_________________________________21_______________
__________________________________7_______________
__________________________________6112____________
_____________________________________5____________
_____________________________________4____________
_____________________________________1____________
_____________________________________34725________
_________________________________________3________
_________________________________________2________
_________________________________________24_______
__________________________________________1431____
_____________________________________________2____
_____________________________________________33479
```

この経路の合計リスクは315です。
（やはり出発点には進入していないので、そのリスクは勘定しません。）

完全なマップを使用して、
**左上から右下への経路の総リスクの最小値はいくつですか？**
