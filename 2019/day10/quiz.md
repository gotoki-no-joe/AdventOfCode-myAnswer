# 10日目：監視ステーション #

あなたは小惑星帯に飛び、セリス監視ステーションに到達します。
ここの妖精達は緊急事態にあります：彼らは小惑星の全てを追跡するのが困難になっていて、
自分たちが安全であると確信することができません。

妖精達は、この宇宙空間の近辺に新しい監視ステーションを建設したいと考えています。
彼らはあなたにその空域の全ての小惑星の地図を渡します（あなたのパズル入力）。

地図は、各位置が空（`.`）か小惑星を含む（`#`）かを示します。
小惑星は地図に表示されるよりもはるかに小さく、
全ての小惑星はその印された位置のちょうど中央にあります。
小惑星は左端からの距離`X`と上端からの距離`Y`による`X,Y`座標で記述します。
（よって左上隅は`0,0`であり、そのすぐ右の位置は`1,0`です。）

あなたの仕事は、どの**小惑星**が**新しい監視ステーション**を建設するのに最適な場所であるかを特定することです。
監視ステーションは、**直接見通し線**がある小惑星を**検出**できます。
つまり、別の小惑星が**ぴったり**見通し線上に存在していてはいけません。
この視線は垂直・水平・対角線だけでなく、任意の角度にすることができます。
**最適**な場所とは、最も多く他の小惑星を**検出**することができる小惑星です。

たとえば、次の地図を考えます。

```
.#..#
.....
#####
....#
...##
```

この地図上の新しい監視ステーションの最適な場所は（原文では強調表示されている）`3,4`です。
ここは8個の小惑星を検出でき、それは他のどの場所よりも多いです。
（それが検出できない唯一の小惑星は`1,0`の小惑星です。
この小惑星の見通し線は`2,2`にある小惑星によりブロックされます。）
他の全ての小惑星はより悪い場所です。
それらは他の小惑星を7個かそれより少ない数しか検出できません。
各小惑星上の監視ステーションが検出できる他の小惑星の数は次のとおりです。

```
.7..7
.....
67775
....7
...87
```

小惑星（`#`）とその視線がブロックされる様子の例を示します。
小文字の印された場所にある小惑星は大文字の印された場所の小惑星にブロックされ、
検出できませんでした。

```
#.........
...A......
...B..a...
.EDCG....a
..F.c.b...
.....c....
..efd.c.gb
.......c..
....f...c.
...e..d..c
```

以下にいくつかの大きな例を示します。

- 最良は33個の他の小惑星を検出できる`5,8`です：

```
......#.#.
#..#.#....
..#######.
.#.#.###..
.#..#.....
..#....#.#
#..#....#.
.##.#..###
##...#..#.
.#....####
```

- 最良は35個の他の小惑星を検出できる`1,2`です：

```
#.#...#.#.
.###....#.
.#....#...
##.#.#.#.#
....#.#.#.
.##..###.#
..#...##..
..##....##
......#...
.####.###.
```

- 最良は41個の他の小惑星を検出できる`6,3`です：

```
.#..#..###
####.###.#
....###.#.
..###.##.#
##.##.#.#.
....###..#
..#.#..#.#
#..#.#.###
.##...##.#
.....#.#..
```

- 最良は210個の他の小惑星を検出できる`11,13`です：

```
.#..##.###...#######
##.############..##.
.#.######.########.#
.###.#######.####.#.
#####.##.#.##.###.##
..#####..#.#########
####################
#.####....###.#.#.##
##.#################
#####.##.###..####..
..######..##.#######
####.##.####...##..#
.#####..#.######.###
##...#.##########...
#.##########.#######
.####.#.###.###.#.##
....##.##.###..#####
.#.#.###########.###
#.#.#.#####.####.###
###.##.####.##.#..##
```

新しい監視ステーションに最適な場所を見つけてください。
**その場所から他の小惑星をいくつ検出できますか？**

# パート2 #

あなたが座標を与えると、
妖精達は即座に仮設監視ステーションをその場所に展開し、
最悪の事態を発見します。
小惑星が多すぎます。

唯一の解決策は**巨大レーザーによる完全な蒸発**です。

幸いなことに、新しい監視ステーションには小惑星スキャナに加えて
小惑星を蒸発させるのに最適な巨大な回転レーザーも装備されています。
レーザーは**上向き**で開始し、常に**時計回り**に回転して、命中した小惑星を蒸発させます。

複数の小惑星がステーションと**正確に**一直線上にある場合、
レーザーは回転により狙いが外れる前にそのうちの**ひとつ**を蒸発させるのに十分な出力しか持っていません。
言い換えれば、**検出**できたその小惑星を蒸発させることができ、
1つの小惑星を蒸発させることにより別の小惑星が検出可能になった場合、
新たに検出された小惑星はレーザーが360度回転して同じ位置に戻るまで蒸発しません。

例として次の地図を考えてみましょう。
ここでは新しい監視ステーション（およびレーザー）のある小惑星を`X`と印しています。

```
.#....#####...#..
##...##.#####..##
##...#...#.#####.
..#.....X...###..
..#.#.....#....##
```

蒸発する最初の9個の小惑星は順に次のようになります。

```
.#....###24...#..
##...##.13#67..9#
##...#...5.8####.
..#.....X...###..
..#.#.....#....##
```

いくつかの小惑星（印1,5,7の小惑星の背後にあるもの）は次の周回まで蒸発する可能性がない
ことに注意してください。
レーザーは回転を続けます。
蒸発する次の9つは：

```
.#....###.....#..
##...##...#.....#
##...#......1234.
..#.....X...5##..
..#.9.....8....76
```

蒸発するさらに次の9つは：

```
.8....###.....#..
56...9#...#.....#
34...7...........
..2.....X....##..
..1..............
```

最後に、レーザーは最初の1回転（1〜3）、2番目の回転（4〜8）を完了し、
3番目の回転の途中で最後の小惑星（9）を蒸発させます。

```
......234.....6..
......1...5.....7
.................
........X....89..
.................
```

上記の大きな例（最適な監視ステーションの場所が`11,13`である例）では：

- 蒸発する最初の小惑星は`11,12`にあります。
- 蒸発する2番目の小惑星は`12,1`にあります。
- 蒸発する3番目の小惑星は`12,2`にあります。
- 蒸発する10番目の小惑星は`12,8`にあります。
- 蒸発する20番目の小惑星は`16,0`にあります。
- 蒸発する50番目の小惑星は`16,9`にあります。
- 蒸発する100番目の小惑星は`10,16`にあります。
- 蒸発する199番目の小惑星は`9,6`にあります。
- **蒸発する200番目の小惑星は`8,2`にあります。**
- 蒸発する201番目の小惑星は`10,9`にあります。
- 蒸発する299番目すなわち最後の小惑星は`11,1`にあります。

妖精達は蒸発する**200番目**の小惑星で賭けをしています。
それがどの小惑星になるかを定めて賭けに勝ちましょう。
**その`X`座標に100を掛けてから`Y`座標を足したらいくつですか？**
（例えば`8,2`は**802**になります。）
