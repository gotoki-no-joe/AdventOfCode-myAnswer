# 10日目: パイプ迷路

ハンググライダーを使って、砂之島からの熱風に乗って、浮遊する金属の島まで移動します。
この島は驚くほど寒く、滑空できる熱気は全くないので、ハンググライダーを置き去りにします。

しばらく歩き回りますが、人や動物の姿は見当たりません。
ただし、時折、見たところ一貫した方向を指している“Hot Springs”（温泉）というラベルの案内看板を見かけます。
温泉で誰かを見つけて、砂漠の機械の部品がどこで作られているか尋ねることができるかもしれません。

ここの風景は異質です。花や木も金属でできています。
立ち止まって金属草を眺めていると、何やら金属質のものが視界の隅をちょろちょろと走り去り、
大きなパイプに飛び込むのに気づきました！
それはあなたが今まで見たどの動物にも似ていませんでした。
もう少しじっくり観察したいのなら、それより先回りする必要があります。

エリアをざっと調べてみると、自分が立っているフィールド全体にパイプが密集していることがわかります。
「地」と同じ金属質の銀色なので、最初は見分けるのが難しかったです。
あなたは、見える限りの全ての表面のパイプについて簡単なスケッチを作成しました（あなたのパズル入力）。

パイプは**マス目**の2次元格子状に配置されます。

- `|` は南北を結ぶ**垂直のパイプ**です。「┃」
- `-` は東西を繋ぐ**水平のパイプ**です。「━」
- `L` は北と東を結ぶ**直角の曲管**です。「┗」
- `J` は北と西を結ぶ**直角の曲管**です。「┛」
- `7` は南と西を結ぶ**直角の曲管**です。「┓」
- `F` は南と東を結ぶ**直角の曲管**です。「┏」
- `.` **地面**です。このマス目にはパイプがありません。
- `S` 動物の**出発地点**です。このマス目にはパイプがありますが、スケッチにはパイプの形状が示されていません。

動物が走り回る音響に基づいて、動物が入っているパイプが**ひとつの大きな連続したループ**であると確信できます。

たとえば、これはパイプの四角いループです。

```
.....
.F-7.
.|.|.
.L-J.
.....
```

動物が北西隅からこのループに入った場合、スケッチは次のようになります。

```
.....
.S-7.
.|.|.
.L-J.
.....
```

この図で、`S` タイルはやはり直角の曲管 `F` です。
そのことは、隣接するパイプがマス目にどのように接続しているかからわかります。

残念ながら、**ループに接続されていないパイプ**も多数あります。
このスケッチは、上記と同じループを示しています。

```
-L|F7
7S-7|
L|7||
-L-J|
L|-JF
```

この図でも、どのパイプがメインループを形成しているかを把握できます。
それらは `S` に接続されているパイプ、そのパイプが接続しているパイプ、それらのパイプが接続しているパイプ…などです。
メインループ内のすべてのパイプは、その2つの隣接パイプに接続します。
これは `S` も例外ではありません。
`S` にはちょうど2つのパイプが接続されており、これらの2つのパイプに接続し返すものと考えます。

以下は、もう少し複雑なメインループを含むスケッチです。

```
..F7.
.FJ|.
SJ.L7
|F--J
LJ...
```

以下は、メインループでない余計なパイプのマス目を含む同じスケッチの例です。

```
7-F7-
.FJ|7
SJLL7
|F--J
LJ.LJ
```

**動物の先回りをしたい**のなら、ループ内の出発地点から**最も遠い**マス目を見つける必要があります。
動物はパイプの中にいるので、これを直接距離で測定することは意味がありません。
代わりに、動物がループのどの方向に進んだかに関係なく、
出発地点から到達するまでに**ループに沿って**最も長い歩数がかかるマス目を見つける必要があります。

正方形のループを使用した最初の例では、

```
.....
.S-7.
.|.|.
.L-J.
.....
```

次のように、ループ内の各マス目の出発地点からの距離を数えられます。

```
.....
.012.
.1.3.
.234.
.....
```

この例では、出発地点から最も遠いポイントは4歩離れたところにあります。

より複雑なループをもう一度示します。

```
..F7.
.FJ|.
SJ.L7
|F--J
LJ...
```

そのループ上の各マス目の距離は次のとおりです。

```
..45.
.236.
01.78
14567
23...
```

`S` から始まる単一の巨大なループを見つけます。
**出発地点から最も遠い点まで到達するのに、ループに沿って何歩かかりますか?**

# パート2

すぐにループの最遠点に到着しますが、動物はいつまでも現れません。
もしかすると、動物の巣が**ループで囲まれた領域内**にあるのでしょうか？

このような巣を探すのに時間を費やす価値があるかどうかを判断するには、
ループ内に含まれるマス目の数を計算する必要があります。例えば：

```
...........
.S-------7.
.|F-----7|.
.||.....||.
.||.....||.
.|L-7.F-J|.
.|..|.|..|.
.L--J.L--J.
...........
```

上のループは、南西と南東の2つの `.` の対（下図では`I`と記した）の**4つのマス目**だけを囲んでいます。
中央の `.` のマス目（下図では`O`と記した）はループ内に**ありません**。
これらの領域に印を付けた同じループをもう一度示します。

```
...........
.S-------7.
.|F-----7|.
.||OOOOO||.
.||OOOOO||.
.|L-7OF-J|.
.|II|O|II|.
.L--JOL--J.
.....O.....
```

実際、マス目をループの外側とみなすのに、外側へのマス目ひとつ分の幅の経路は必要ありません。
パイプの間を惜し通ることも許されます。
次の図で、`I`はやはりループ内にあり、`O`はやはりループの外にあります。

```
..........
.S------7.
.|F----7|.
.||OOOO||.
.||OOOO||.
.|L-7F-J|.
.|II||II|.
.L--JL--J.
..........
```

上記のどちらの例でも、**4**つのマス目がループで囲まれています。

より大きな例を次に示します。

```
.F----7F7F7F7F-7....
.|F--7||||||||FJ....
.||.FJ||||||||L7....
FJL7L7LJLJ||LJ.L-7..
L--J.L7...LJS7F-7L7.
....F-J..F7FJ|L7L7L7
....L7.F7||L7|.L7L7|
.....|FJLJ|FJ|F7|.LJ
....FJL-7.||.||||...
....L---J.LJ.LJLJ...
```

このスケッチには多数のランダムな地面の小片が含まれており、
その一部はループ内にあり (`I`)、一部はその外側にあります (`O`)。

```
OF----7F7F7F7F-7OOOO
O|F--7||||||||FJOOOO
O||OFJ||||||||L7OOOO
FJL7L7LJLJ||LJIL-7OO
L--JOL7IIILJS7F-7L7O
OOOOF-JIIF7FJ|L7L7L7
OOOOL7IF7||L7|IL7L7|
OOOOO|FJLJ|FJ|F7|OLJ
OOOOFJL-7O||O||||OOO
OOOOL---JOLJOLJLJOOO
```

この大きな例では、**8**個のマス目がループで囲まれています。

メインループの一部ではないタイルは、ループに囲まれているものとして数えられます。
以下は、メインループにまったく接続されていないゴミのパイプが多数存在する別の例です。

```
FF7FSF7F7F7F7F7F---7
L|LJ||||||||||||F--J
FL-7LJLJ||||||LJL-77
F--JF--7||LJLJ7F7FJ-
L---JF-JLJ.||-FJLJJ7
|F|F-JF---7F7-L7L|7|
|FFJF7L7F-JF7|JL---7
7-L-JL7||F7|L7F-7F7|
L.L7LFJ|||||FJL7||LJ
L7JLJL-JLJLJL--JLJ.L
```

**ループで囲まれた**マス目のみを `I` で示します。
（訳注：`O`の方は省略します。）

```
FF7FSF7F7F7F7F7F---7
L|LJ||||||||||||F--J
FL-7LJLJ||||||LJL-77
F--JF--7||LJLJIF7FJ-
L---JF-JLJIIIIFJLJJ7
|F|F-JF---7IIIL7L|7|
|FFJF7L7F-JF7IIL---7
7-L-JL7||F7|L7F-7F7|
L.L7LFJ|||||FJL7||LJ
L7JLJL-JLJLJL--JLJ.L
```

この最後の例では、**10**個のマス目がループで囲まれています。

ループ内の面積を計算して、巣を探す時間があるかどうかを判断します。
**ループで囲まれたマス目はいくつありますか？**
