# 16日目: 床が溶岩になります

光線が**どこかしら**に完全に集中すると、トナカイは溶岩製造施設のさらに奥深くへとあなたを導きます。
いつの間にか、鋼鉄の施設の壁が洞窟に変わっており、出入り口も床も洞窟になっていることに気づき、
これは実際にただの巨大な洞窟であると確信します。

ついに、山の中心部と思われる場所に近づくと、前方の洞窟に明るい光が見えます。
そこで、あなたが注意深く焦点を合わせた光が、施設に最も近い洞窟の壁から出てきて、
そのエネルギーの全てが反対側にあるヘンテコな装置に注がれていることに気づきました。

よく観察すると、このヘンテコ装置は平らな2次元の正方形のマス目からなっています。
マス目は**空き空間** (`.`)、**鏡** (`/`と`\`)、**スプリッター** (`|`と`-`) のいずれかです。

この装置は、ビームの大部分がマス目を反射して行き交うように配置されていますが、
格子上の各マスはビームの光の一部を洞窟の岩を溶かす**熱**に変換します。

あなたは仕掛けのレイアウトを書き留めます（あなたのパズル入力）。
例えば：

```
.|...\....
|.-.\.....
.....|-...
........|.
..........
.........\
..../.\\..
.-.-/..|..
.|....-|.\
..//.|....
```

ビームは左から左上隅に入り、**右**に向かっています。
そして、その動作は、移動中に遭遇したものによって決まります。

- ビームが**空き空間**  (`.`) に遭遇すると、同じ方向に進み続けます。
- ビームが**鏡** (`/` または `\`)に当たった場合、ビームは鏡の角度に応じて直角に**反射**されます。
例えば、右方向に移動するビームが鏡 `/` に当たると、鏡のある列を**上向き**に進み続けます。
一方、右方向に移動するビームが鏡 `\` に当たると、鏡のある列を**下向き**に進みます。
- ビームが**スプリッター** (`|` または `-`)の**尖った端**に当たった場合、
ビームは、スプリッターが**空き空間**であるかのようにスプリッターを素通りします。
例えば、右方向に移動するビームがスプリッター `-` に遭遇すると、同じ方向に進み続けます。
- ビームが**スプリッターの平らな面**に当たった場合、ビームは2つのビームに分割され、
スプリッターの尖った端が向いている2つの方向のそれぞれに進みます。
例えば、右方向に移動するビームがスプリッター `|` 遭遇すると、2つのビームに分割されます。
一つはスプリッターの列を**上向き**に進みます。
もう一つはスプリッターの列を**下向きに**に進みます。

ビームは他のビームと干渉しません。
ひとつのマス目を同時に多数のビームが通過することがあります。
少なくとも1つのビームがマス目を通過、マス目で反射、または分割された場合、そのマス目は**熱が蓄積**されます。

上の例で、光のビームが装置の中をどのように通るかを示します。

```
>|<<<\....
|v-.\^....
.v...|->>>
.v...v^.|.
.v...v^...
.v...v^..\
.v../2\\..
<->-/vv|..
.|<<<2-|.\
.v//.|.v..
```

ビームは空のタイルにのみ示しています。矢印はビームの方向を示します。
マス目に複数の方向に移動するビームが含まれている場合は、代わりに個別の方向の数が表示されます。
下は同じ図ですが、マス目が**加熱されている** (`#`) かそうでないか (`.`) のみを示しています。

```
######....
.#...#....
.#...#####
.#...##...
.#...##...
.#...##...
.#..####..
########..
.#######..
.#...#.#..
```

最終的に、この例では、**46**タイルが**加熱**されます。

光は溶岩を生成するのに十分な数のマス目を加熱していません。
装置をデバッグするには、現在の状況を分析することから始める必要があります。
ビームが左上から右に向かって始まった場合、**何個のマス目が加熱されますか？**

# パート2

何が問題なのかを調べようとしていると、トナカイがあなたのシャツを引っ張り、近くの制御盤に誘導します。
ここでは、一連のボタンを使用して、ビームが**任意の端のマス目**から入射しその端から遠ざかるように装置を調整できます。
（ビームが角から始まる場合は、ビームの向きは2つの方向のどちらも選択できます。
例えば、ビームが右下隅から始まる場合は、左または上に向かって開始できます。）

したがって、ビームは、上の行の任意のマス目から（下向きに）、
下の行の任意のマス目から（上向きに）、左端の列の任意のマス目から（右向きに）、
右端の列の任意のマス目から（左向きに）開始できます。
溶岩を生成するには、**できるだけ多くのマス目を加熱する**設定を見つける必要があります。

上の例では、最上行の左から4番目のマス目からビームを開始することでこれを達成できます。

```
.|<2<\....
|v-v\^....
.v.v.|->>>
.v.v.v^.|.
.v.v.v^...
.v.v.v^..\
.v.v/2\\..
<-2-/vv|..
.|<<<2-|.\
.v//.|.v..
```

この設定を使用すると、**51**個のマス目が加熱されます。

```
.#####....
.#.#.#....
.#.#.#####
.#.#.##...
.#.#.##...
.#.#.##...
.#.#####..
########..
.#######..
.#...#.#..
```

最大個数のマス目を加熱する初期ビーム設定を見つけます。
**その設定では何個のマス目が過熱されますか？**
